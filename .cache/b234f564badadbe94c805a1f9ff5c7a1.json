{"dependencies":[{"name":"/mnt/data/hacking/projects/personal/jp.tamagotchi.rest.koa/tsconfig.json","includedInParent":true,"mtime":1527650976754},{"name":"/mnt/data/hacking/projects/personal/jp.tamagotchi.rest.koa/package.json","includedInParent":true,"mtime":1528316321058},{"name":"koa-passport","loc":{"line":46,"column":39}},{"name":"passport-local","loc":{"line":47,"column":31}},{"name":"typeorm","loc":{"line":48,"column":24}},{"name":"./repositories/LoginRepository","loc":{"line":49,"column":32}}],"generated":{"js":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n            try {\n                step(generator.next(value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function rejected(value) {\n            try {\n                step(generator[\"throw\"](value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function step(result) {\n            result.done ? resolve(result.value) : new P(function (resolve) {\n                resolve(result.value);\n            }).then(fulfilled, rejected);\n        }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n    var _ = { label: 0, sent: function sent() {\n            if (t[0] & 1) throw t[1];return t[1];\n        }, trys: [], ops: [] },\n        f,\n        y,\n        t,\n        g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n    }), g;\n    function verb(n) {\n        return function (v) {\n            return step([n, v]);\n        };\n    }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) {\n            try {\n                if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n                if (y = 0, t) op = [0, t.value];\n                switch (op[0]) {\n                    case 0:case 1:\n                        t = op;break;\n                    case 4:\n                        _.label++;return { value: op[1], done: false };\n                    case 5:\n                        _.label++;y = op[1];op = [0];continue;\n                    case 7:\n                        op = _.ops.pop();_.trys.pop();continue;\n                    default:\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                            _ = 0;continue;\n                        }\n                        if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                            _.label = op[1];break;\n                        }\n                        if (op[0] === 6 && _.label < t[1]) {\n                            _.label = t[1];t = op;break;\n                        }\n                        if (t && _.label < t[2]) {\n                            _.label = t[2];_.ops.push(op);break;\n                        }\n                        if (t[2]) _.ops.pop();\n                        _.trys.pop();continue;\n                }\n                op = body.call(thisArg, _);\n            } catch (e) {\n                op = [6, e];y = 0;\n            } finally {\n                f = t = 0;\n            }\n        }if (op[0] & 5) throw op[1];return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importStar = this && this.__importStar || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) {\n        if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    }result[\"default\"] = mod;\n    return result;\n};\nvar _this = this;\nexports.__esModule = true;\nvar KoaPassport = __importStar(require(\"koa-passport\"));\nvar passport_local_1 = require(\"passport-local\");\nvar typeorm_1 = require(\"typeorm\");\nvar LoginRepository_1 = require(\"./repositories/LoginRepository\");\nexports.Passport = KoaPassport.use(new passport_local_1.Strategy({ session: false }, function (username, password, done) {\n    return __awaiter(_this, void 0, void 0, function () {\n        var user, error_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2,, 3]);\n                    return [4 /*yield*/, typeorm_1.getRepository(LoginRepository_1.LoginRepository).findOne({\n                        where: { username: username, password: password }\n                    })];\n                case 1:\n                    user = _a.sent();\n                    done(null, user);\n                    return [3 /*break*/, 3];\n                case 2:\n                    error_1 = _a.sent();\n                    done(error_1);\n                    return [3 /*break*/, 3];\n                case 3:\n                    return [2 /*return*/];\n            }\n        });\n    });\n}));","map":{"mappings":[{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":91,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":91,"column":4}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":91,"column":12}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":91,"column":16}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":4}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":18}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":31}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":39}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":53}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":54}},{"source":"App.auth.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":93,"column":55}},{"source":"App.auth.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":94,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":94,"column":4}},{"source":"App.auth.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":94,"column":23}},{"source":"App.auth.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":94,"column":31}},{"source":"App.auth.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":94,"column":47}},{"source":"App.auth.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":94,"column":48}},{"source":"App.auth.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":95,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":95,"column":4}},{"source":"App.auth.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":95,"column":16}},{"source":"App.auth.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":95,"column":24}},{"source":"App.auth.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":95,"column":33}},{"source":"App.auth.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":95,"column":34}},{"source":"App.auth.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":96,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":96,"column":4}},{"source":"App.auth.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":96,"column":24}},{"source":"App.auth.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":96,"column":32}},{"source":"App.auth.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":96,"column":64}},{"source":"App.auth.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":96,"column":65}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":13},"generated":{"line":97,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":13},"generated":{"line":97,"column":8}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":13},"generated":{"line":97,"column":16}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":24},"generated":{"line":97,"column":19}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":36},"generated":{"line":97,"column":31}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":24},"generated":{"line":97,"column":34}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":2},"generated":{"line":97,"column":35}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":6},"generated":{"line":97,"column":39}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":6},"generated":{"line":97,"column":56}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":2},"generated":{"line":97,"column":64}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":20},"generated":{"line":97,"column":65}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":22},"generated":{"line":97,"column":67}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":31},"generated":{"line":97,"column":76}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":20},"generated":{"line":97,"column":81}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":2},"generated":{"line":97,"column":83}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":40},"generated":{"line":97,"column":85}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":47},"generated":{"line":97,"column":95}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":40},"generated":{"line":97,"column":103}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":57},"generated":{"line":97,"column":105}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":40},"generated":{"line":97,"column":113}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":67},"generated":{"line":97,"column":115}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":40},"generated":{"line":97,"column":119}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":97,"column":121}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":11}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":21}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":26}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":28}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":33}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":34}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":36}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":41}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":42}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":44}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":98,"column":56}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":104,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":104,"column":27}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":104,"column":28}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":104,"column":29}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":104,"column":30}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":104,"column":39}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":25},"generated":{"line":104,"column":41}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":25},"generated":{"line":104,"column":51}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":25},"generated":{"line":104,"column":64}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":39},"generated":{"line":104,"column":65}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":39},"generated":{"line":104,"column":83}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":25},"generated":{"line":104,"column":98}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":56},"generated":{"line":104,"column":100}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":25},"generated":{"line":104,"column":107}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":64},"generated":{"line":104,"column":108}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":8},"generated":{"line":105,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":15},"generated":{"line":105,"column":31}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":17},"generated":{"line":105,"column":33}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":25},"generated":{"line":105,"column":43}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":15},"generated":{"line":105,"column":51}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":27},"generated":{"line":105,"column":53}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":35},"generated":{"line":105,"column":63}},{"source":"App.auth.ts","name":null,"original":{"line":13,"column":15},"generated":{"line":105,"column":71}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":64},"generated":{"line":106,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":25},"generated":{"line":106,"column":21}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":106,"column":22}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":106,"column":23}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":12},"generated":{"line":108,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":108,"column":27}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":108,"column":30}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":19},"generated":{"line":108,"column":34}},{"source":"App.auth.ts","name":null,"original":{"line":12,"column":12},"generated":{"line":108,"column":36}},{"source":"App.auth.ts","name":null,"original":{"line":15,"column":6},"generated":{"line":109,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":15,"column":11},"generated":{"line":109,"column":25}},{"source":"App.auth.ts","name":null,"original":{"line":15,"column":6},"generated":{"line":109,"column":29}},{"source":"App.auth.ts","name":null,"original":{"line":15,"column":17},"generated":{"line":109,"column":31}},{"source":"App.auth.ts","name":null,"original":{"line":15,"column":6},"generated":{"line":109,"column":35}},{"source":"App.auth.ts","name":null,"original":{"line":17,"column":6},"generated":{"line":113,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":17,"column":11},"generated":{"line":113,"column":25}},{"source":"App.auth.ts","name":null,"original":{"line":17,"column":6},"generated":{"line":113,"column":32}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":119,"column":5}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":71},"generated":{"line":119,"column":6}},{"source":"App.auth.ts","name":null,"original":{"line":19,"column":3},"generated":{"line":120,"column":0}},{"source":"App.auth.ts","name":null,"original":{"line":10,"column":2},"generated":{"line":120,"column":1}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":24},"generated":{"line":120,"column":2}},{"source":"App.auth.ts","name":null,"original":{"line":9,"column":13},"generated":{"line":120,"column":3}}],"sources":{"App.auth.ts":"import * as KoaPassport from 'koa-passport';\n\nimport { Strategy as LocalStrategy } from 'passport-local';\n\nimport { getRepository } from 'typeorm';\n\nimport { LoginRepository } from './repositories/LoginRepository';\n\nexport const Passport = KoaPassport.use(\n  new LocalStrategy({ session: false }, async (username, password, done) => {\n    try {\n      const user = await getRepository(LoginRepository).findOne({\n        where: { username, password }\n      });\n      done(null, user);\n    } catch (error) {\n      done(error);\n    }\n  })\n);\n"},"lineCount":null}},"hash":"6da525ce871e2a6af95484757a259205","cacheData":{"env":{}}}